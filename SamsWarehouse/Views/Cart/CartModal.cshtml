@model List<Cart>

@{
    var currentCart = Model.First();
    var total = "$0.00";
    var title = "Cart";
}
@if (!(currentCart == null || currentCart.CartItems == null || currentCart.CartItems.Count == 0))
{
    total = currentCart.total.ToString("c2");
    title = currentCart.Name;


}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@40,400,0,0" />
<div class="offcanvas-header">
    <div class="btn-group dropdown w-100">
        <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
            @currentCart.Name
        </button>
        <ul class="dropdown-menu w-100" >

            @foreach (var cart in Model)
            {
                if (cart.Id == currentCart.Id)
                {
                    <li>
                        <tr>
                            <a class="dropdown-item active d-flex justify-content-lg-between" aria-current="true" onclick="switchCart(@cart.Id)">@cart.Name</a>
                        </tr>
                    </li>
                }
                else
                {
                    <li>
                        <tr>
                            <a class="dropdown-item d-flex justify-content-lg-between" onclick="switchCart(@cart.Id)">
                                @cart.Name<span type="button" onclick="removeCart(@cart.Id)" class="material-symbols-rounded w-25 h-25">
                                    delete
                                </span>
                            </a>
                        </tr>
                    </li>
                }
            }
            <li><hr class="dropdown-divider"></li>
            <div class="input-group">
                <input id="newCartName" type="text" class="form-control" placeholder="Add New Cart" aria-label="Add New Cart" aria-describedby="basic-addon2" >
                <div class="input-group-append">
                    <a  class="btn btn-outline-secondary mx-2 d-flex" id="createCart" onclick="createCart(document.getElementById('newCartName').value);" type="button">Create</a>
                </div>
            </div>

            
        </ul>
    </div>
    @*<h5 id="offcanvasRightLabel">@title</h5>*@
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
</div>
<div class="offcanvas-body">
    <hr />
<label>
    <tr>
        <b>Total:</b>
            <span class="badge ms-1 rounded-pill" id="total">@total</span>
    </tr>
</label>

    @if (currentCart == null || currentCart.CartItems == null || currentCart.CartItems.Count == 0)
{

    <p>Cart is empty</p>
}
else
{




        @foreach (var product in currentCart.CartItems)
{
            


        <hr />
        <div class="row">
            <div class="col-3">
                <img src="@Url.Content("~/images/thumbnail/" + product.Product.Id +"/"+ product.Product.Id +"_1.webp")" alt="..." class="img-thumbnail">
            </div>
            <div class="col-8">
                <div class="row">
                    <div class="col-12">
                        <h6>@product.Product.Title</h6>
                    </div>
                    <div class="col-12">
                        <h6>@product.Product.Price.ToString("c2")</h6>
                    </div>
                    <div class="col-12">
                            <div class="d-flex align-items-center">
                                <input id="form1" min="0" name="quantity" value="@product.Quantity" type="number" class="form-control form-control-sm" onchange="setQuantityCart(@product.ProductId,this.value)">
                                <span type="button" onclick="removeFromCart(@product.ProductId)" class="material-symbols-rounded w-25 h-25">
                                    delete
                                </span>
                
                            </div>
                    </div>
                </div>
            </div>
            
        </div>
    
}   
    
}
</div>